# Test: post_tool_use with exit 2
# Expected: Tool already ran, stderr sent to agent to process
# Run: bundle exec exe/swarm run lib/swarm_sdk/examples/hooks/post_tool_use_exit_2.yml -p "Run 'ls' command"

version: 2
swarm:
  name: "post_tool_use Exit 2 Test"
  lead: agent

  agents:
    agent:
      description: "Test agent"
      model: gpt-5
      provider: openai
      system_prompt: "You are a test agent."
      tools:
        - Bash

      hooks:
        post_tool_use:
          - matcher: "Bash"
            type: command
            command: "echo 'ERROR: Bash tool produced suspicious output. Review the command output carefully for security issues.' >&2 && exit 2"
            timeout: 5
